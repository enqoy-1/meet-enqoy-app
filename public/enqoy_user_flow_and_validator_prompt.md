
# ENQOY User Flow and Antigravity Validator Prompt

## Authoritative User Flow Specification

### A) New User Journey
1. **Homepage**
   - Multiple CTAs (hero, mid-page, footer).
   - All CTAs route the user to the **Create Account** page.

2. **Create Account → Personality Assessment**
   - After signup, the user is automatically redirected to the **Personality Assessment**.
   - No card information is requested.
   - No photo or biography is required.

3. **Assessment → Dashboard**
   - When assessment is submitted, user is routed to the **User Dashboard**.

4. **User Dashboard**
   - Sections:
     - **Upcoming Events (catalog)**
     - **My Upcoming Events**
     - **Past Events**
     - **Profile**
   - Users can browse and book events.

5. **Booking**
   - Booking occurs on the event detail page.
   - After successful booking, the event should appear **immediately** in **My Upcoming Events**.

6. **Pairing & Venue**
   - Admin assigns a user via **Admin ▸ Pairing**.
   - User sees their **venue/restaurant** and location on the booking detail/logistics page.

7. **Icebreaker (Day-Of Only)**
   - On the event day, a button labeled **Ice Breakers** appears.
   - Opens a mobile-first swipeable card interface populated from **Admin ▸ Icebreakers**.

8. **Post-Event**
   - Booking moves to **Past Events**.
   - User is prompted to fill in a **post-event feedback form**.

---

### B) Returning User Journey

1. **Sign In → Dashboard**
   - User sees:
     - **Upcoming Events (catalog)**
     - **My Upcoming Events**
     - **Past Events**
   - Tapping any booked event opens **Booking Detail**, showing venue information (if assigned).
   - On event day, Ice Breakers are visible.
   - After the event passes, it moves to **Past Events**, prompting feedback.

---

### C) Profile
- Users can edit personal details.
- Users can retake or modify their personality assessment responses.

---

### D) Reschedule / Cancel Policy
- User can **reschedule or cancel** up to **48 hours before event start**.
- Rescheduling is permitted only to an event with:
  - **The same price**
  - **Available capacity**
- Inside T-48h, both options are disabled.

---

## Antigravity Validator + Auto-Fix Prompt

**Objective:**  
Validate and auto-fix the current Enqoy build to match the Authoritative Specification above.

### 1. Route Mapping
- Map each user flow step to an existing route/component.
- If missing, identify the nearest alternative route and describe what’s incorrect.

### 2. Seed Data
Include:
- 12 QA users.
- 6 venues.
- 10 events within 21 days (at least one within 72h, one past, two same-price).
- 40 icebreaker questions.

### 3. Time Travel Testing
Implement a QA-only flag:
```
QA_TIME_TRAVEL=true
```
Supports:
- T-48h
- T-24h
- T-0
- T+2h

### 4. E2E Tests
Tagged as:
- `@core`
- `@policy`
- `@admin`
- `@mobile`

Tests include:
- Homepage CTAs → Signup
- Signup → Assessment → Dashboard
- Dashboard lists populate correctly
- Booking flow + immediate appearance under “My Upcoming Events”
- Admin pairing visibility
- Icebreaker visibility rules
- Past event transition + feedback form
- Profile update + retake assessment
- Reschedule rules (same price + capacity)
- Cancel and reschedule disabled inside T‑48h
- Non-admin access restricted

### 5. Auto-Fix Requirements
Implement minimal safe fixes:
- Reliability of “My Upcoming Events” query + state refresh
- Same-price rescheduling rules on backend + frontend
- T‑48h policy enforcement at backend + frontend
- Icebreaker toggle based on event local time
- Pairing linkage on booking detail screen

### 6. Deliverables
Generated by Antigravity:
- `README-QA.md`
- Flow Compliance Report (table)
- Known Issues list

### 7. Acceptance Criteria
- Every user flow verified or test‑flagged
- Booking always appears in **My Upcoming Events**
- Pairing venue visible when assigned
- Icebreakers appear only on the event day
- Past events correctly categorized
- Rescheduling & cancellation rules enforced
- Non-admin restricted from admin area

---

## Known Bug Addressed: “Booking Not Showing Under My Upcoming Events”
Most likely causes:
- Incorrect `status` filter.
- Inner join exclusion.
- Timezone mismatch pulling future events into past category.
- Dashboard not refreshing post-booking.

Minimal fix queries included in detailed prompt.

---

# Export This File

This markdown file contains the complete user flow and the Antigravity validator prompt.
